var $localstorage=function(n){return{set:function(t,i){n.localStorage[t]=i},get:function(t,i){return n.localStorage[t]||i},setObject:function(t,i){n.localStorage[t]=JSON.stringify(i)},getObject:function(t){try{var i=n.localStorage[t];if(i)return JSON.parse(i||"{}")}catch(r){return JSON.parse("{}")}},remove:function(t){n.localStorage.removeItem(t)},clearAll:function(){n.localStorage.clear()}}},ApiHelper,CommonHelper,DataFactory,UtilFactory;$localstorage.$inject=["$window"];ApiHelper=function(n,t,i,r,u){var f={};return f.CheckCacheExist=n=>{let r=DataCacheKey[n];if(!r)return!1;let i=t.getObject(n);return i?i.version!=r?!1:i.data?!0:!1:!1},f.GetCache=n=>{let i=t.getObject(n);return i.data},f.AddCache=(n,i)=>{let u=DataCacheKey[n];if(u){let r={};r.version=u;r.data=i;t.remove(n);t.setObject(n,r)}},f.CodeStep={Status:"",StatusCode:0,ErrorStep:"",Message:"",ErrorMessage:"",Data:""},f.JsonStatusCode={Success:"Success",Error:"Error",Warning:"Warning",Info:"Info"},f.Status={CreateSuccess:"Tạo thành công!",CreateFail:"Tạo thất bại!",UpdateSuccess:"Cập nhật thành công!",UpdateFail:"Cập nhật thất bại!",DeleteSuccess:"Xóa thành công!",DeleteFail:"Xóa thất bại!"},f.GetMethod=function(n,t){let e=r.defer(),i=jQuery.extend({},ApiHelper.CodeStep);var o={method:"GET",url:n,data:t};return u(o).then(function(r){r.status==204?(i=f.SetErrorAPI(r,n,t),e.reject(i)):(i.Status=f.JsonStatusCode.Success,i.Data=r.data,e.resolve(i))},function(r){i=f.SetErrorAPI(r,n,t);e.reject(i)}),e.promise},f.PostMethod=function(n,t){let i=jQuery.extend({},ApiHelper.CodeStep),e=r.defer();var o={method:"POST",url:n,data:t};return u(o).then(function(r){r.status==204?(i=f.SetErrorAPI(r,n,t),e.reject(i)):(i.Status=f.JsonStatusCode.Success,i.Data=r.data,e.resolve(i))},function(r){i=f.SetErrorAPI(r,n,t);e.reject(i)}),e.promise},f.PutMethod=function(n,t){let i=jQuery.extend({},ApiHelper.CodeStep),e=r.defer();var o={method:"PUT",url:n,data:t};return u(o).then(function(r){r.status==204?(i=f.SetErrorAPI(r,n,t),e.reject(i)):(i.Status=f.JsonStatusCode.Success,i.Data=r.data,e.resolve(i))},function(r){i=f.SetErrorAPI(r,n,t);e.reject(i)}),e.promise},f.DeleteMethod=function(n,t){let i=jQuery.extend({},ApiHelper.CodeStep),e=r.defer();var o={method:"DELETE",url:n,data:t};return u(o).then(function(r){r.status==204?(i=f.SetErrorAPI(r,n,t),e.reject(i)):(i.Status=f.JsonStatusCode.Success,i.Data=r.data,e.resolve(i))},function(r){i=f.SetErrorAPI(r,n,t);e.reject(i)}),e.promise},f.SetErrorAPI=function(n,t){var i=jQuery.extend({},f.CodeStep),r;if(n.status!=200&&n.status!=201){i.Status=f.JsonStatusCode.Error;i.StatusCode=n.status;i.ErrorStep="API error "+n.status+", ApiEndPoint:"+t;switch(n.status){case 406:r=n.data;i.Status=f.JsonStatusCode.Warning;i.Message=r;jQuery.type(r)=="array"&&(i.Message=r.join("<\/br>"));break;case 500:i.ErrorMessage=n.data;i.Message=f.StatusCodeMessage(n.status);break;case 204:i.Message="Không có dữ liệu hoặc bạn không có quyền xem dữ liệu";i.Status=f.JsonStatusCode.Warning;break;default:i.Message=f.StatusCodeMessage(n.status)}return i}},f.StatusCodeMessage=function(n){var t="";switch(n){case 400:t="Lỗi dữ liệu không hợp lệ";break;case 401:t="Phiên làm việc đã hết hạn, vui lòng đăng nhập lại.";break;case 403:t="Bạn không có quyền thực hiện thao tác này.";break;case 404:t="URL action không chính xác";break;case 405:t="Phương thức không được chấp nhận";break;case 429:t="Thao tác quá nhanh";break;case 500:t="Lỗi hệ thống";break;case 502:t="Đường truyền kém";break;case 503:t="Dịch vụ không hợp lệ";break;case 504:t="Hết thời gian chờ";break;case 440:t="Phiên đăng nhập đã hết hạn, vui lòng đăng nhập lại";break;default:t="Lỗi chưa xác định"}return t},f.ConfirmRedirectLogin=function(){n.IsShowConfirmRedirectLogin||(n.IsShowConfirmRedirectLogin=!0,bootbox.alert({title:"Thông báo",message:"Phiên làm việc đã hết hạn, vui lòng đăng nhập lại…",callback:function(){n.IsShowConfirmRedirectLogin=!1;window.location.href="/Home/Logout"}}))},f.NotPermission=function(){bootbox.alert({title:"Thông báo",message:"Bạn không có quyền thực hiện thao tác này…",callback:function(){}})},f};ApiHelper.$inject=["$rootScope","$localstorage","$timeout","$q","$http"];CommonHelper=function(){let t="http://localhost:51581/api/",n={};return n.ConfigUrl=t+"Configs/",n.MenuUrl=t+"Menus/",n.CurrencyUrl=t+"Currencies/",n.TransactionUrl=t+"Transactions/",n.RoleUrl=t+"Roles/",n.UserUrl=t+"Users/",n.DepWithType={},n.DepWithType.Deposit=0,n.DepWithType.Withdraw=1,n.StatusTransaction={},n.StatusTransaction.Pending=0,n.StatusTransaction.Confirmed=1,n.StatusTransaction.Cancel=2,n};CommonHelper.$inject=["$rootScope","$localstorage","$timeout","$q","$http"];DataFactory=function(n,t,i,r,u,f,e,o){var s={};return s.CheckCacheExist=n=>{let r=DataCacheKey[n];if(!r)return!1;let i=t.getObject(n);return i?i.version!=r?!1:i.data?!0:!1:!1},s.GetCache=n=>{let i=t.getObject(n);return i.data},s.AddCache=(n,i)=>{let u=DataCacheKey[n];if(u){let r={};r.version=u;r.data=i;t.remove(n);t.setObject(n,r)}},s.UserTypes_Get=function(){let n=ApiEndPoint.UserTypeResource;return e.GetMethod(n)},s.Users_Get=()=>{let n=u.defer(),t=ApiEndPoint.UserResource;return e.GetMethod(t).then(function(t){t.Data=t.Data.filter(n=>n.Username&&n.FullName);n.resolve(t)}).catch(function(t){n.reject(t)}),n.promise},s.Stores_Get=function(){let n=u.defer(),t=ApiEndPoint.StoreResource;return e.GetMethod(t).then(function(t){t.Data.forEach(n=>{n.id=n.StoreID,n.text=n.StoreName,n.parent="#"});n.resolve(t)}).catch(function(t){n.reject(t)}),n.promise},s.Menus_Get=function(){let n=u.defer(),t=o.MenuUrl+"list";return e.GetMethod(t).then(function(t){t.Data.forEach(n=>{(n.ParentId||n.ParentId>0)&&(n.ParentName=t.Data.filter(t=>t.Id==n.ParentId)[0].Name)});n.resolve(t)}).catch(function(t){n.reject(t)}),n.promise},s};DataFactory.$inject=["$rootScope","$localstorage","$timeout","UtilFactory","$q","$http","ApiHelper","CommonHelper"];UtilFactory=function(n,t,i){var r={};return r.WaitingLoadDirective=function(n){clearInterval(r.myTimer);let t=i.defer();return r.myTimer=setInterval(()=>{let i=_.find(n,n=>n.IsReady==undefined||n.IsReady==!1);i||(clearInterval(r.myTimer),t.resolve())},100),t.promise},r.InitArrayNoIndex=function(n){for(var i=[],t=1;t<n;t++)i.push(t);return i},r.String={},r.String.IsNullOrEmpty=function(n){return!n||n==null?!0:!1},r.String.IsContain=function(n,t){return r.String.IsNullOrEmpty(n)?!1:r.String.IsNullOrEmpty(t)?!0:n.indexOf(t)<0?!1:!0},r.Alert={},r.Alert.RequestError=function(n){console.log(n);var t="";switch(n.status){case 400:t="Lỗi dữ liệu không hợp lệ";break;case 401:t="Phiên làm việc đã hết hạn, vui lòng đăng nhập lại.";break;case 403:t="Bạn không có quyền thực hiện thao tác này.";break;case 404:t="URL action không chính xác";break;case 405:t="Phương thức không được chấp nhận";break;case 500:t="Lỗi hệ thống";break;case 502:t="Đường truyền kém";break;case 503:t="Dịch vụ không hợp lệ";break;case 504:t="Hết thời gian chờ";break;case 440:t="Phiên đăng nhập đã hết hạn, vui lòng đăng nhập lại";break;default:t="Lỗi chưa xác định"}sys.Alert(!1,t)},r};UtilFactory.$inject=["$rootScope","$timeout","$q"];